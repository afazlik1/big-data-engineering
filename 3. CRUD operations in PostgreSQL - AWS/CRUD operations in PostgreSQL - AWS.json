{"paragraphs":[{"title":"Install required python package using Docker CLI","text":"%md\n\n<img src=\"https://i.ibb.co/9yHYrrB/2020-07-15.jpg\" alt=\"2020-07-15\" border=\"0\">\n<img src=\"https://i.ibb.co/pWvz8hV/2020-07-15-1.png\" alt=\"2020-07-15-1\" border=\"0\">","user":"anonymous","dateUpdated":"2020-07-15T09:26:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<img src=\"https://i.ibb.co/9yHYrrB/2020-07-15.jpg\" alt=\"2020-07-15\" border=\"0\">\n<img src=\"https://i.ibb.co/pWvz8hV/2020-07-15-1.png\" alt=\"2020-07-15-1\" border=\"0\">\n</div>"}]},"apps":[],"jobName":"paragraph_1594464571229_1077217303","id":"20200711-104931_1184557072","dateCreated":"2020-07-11T10:49:31+0000","dateStarted":"2020-07-15T09:26:41+0000","dateFinished":"2020-07-15T09:26:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:193"},{"title":"PostgresSQL Commands Reference","text":"%md\nhttps://www.postgresqltutorial.com/","user":"anonymous","dateUpdated":"2020-07-11T14:08:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","title":true,"editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p><a href=\"https://www.postgresqltutorial.com/\">https://www.postgresqltutorial.com/</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1594476487612_375119638","id":"20200711-140807_1759068323","dateCreated":"2020-07-11T14:08:07+0000","dateStarted":"2020-07-11T14:08:53+0000","dateFinished":"2020-07-11T14:08:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:194"},{"text":"%md\n<li>We have already created empty Database with the name <b>'ioadatabase'</b> in AWS (us-east-1) by loggin into AWS Console.</li>\n<li>The Database details for connection are given below. </li>\n<li>In the following steps we will connect and create tables in the Database.</li>","user":"anonymous","dateUpdated":"2020-07-15T09:59:55+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<li>We have already created empty Database with the name <b>'ioadatabase'</b> in AWS (us-east-1) by loggin into AWS Console.</li>\n<li>The Database details for connection are given below. </li>\n<li>In the following steps we will connect and create tables in the Database.</li>\n</div>"}]},"apps":[],"jobName":"paragraph_1594646873236_1911031597","id":"20200713-132753_1749282902","dateCreated":"2020-07-13T13:27:53+0000","dateStarted":"2020-07-15T09:59:55+0000","dateFinished":"2020-07-15T09:59:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:195"},{"title":"Connecting to AWS RDS (PostgreSQL)","text":"%pyspark\r\n\r\nimport psycopg2\r\n\r\nENDPOINT=\"mydbinstance.c3dm5owknewm.us-east-1.rds.amazonaws.com\" #Relational Database Service (Amazon RDS) endpoint.  Incase of local DB use 'localhost' or '127.0.0.1'\r\nPORT=\"5432\" #Default Port number used at the time of creation of PostgreSQL service running in AWS\r\nDBNAME=\"ioadatabase\" #Database name used at the time of creation of DB\r\nUSR=\"ioausa\" #Database Master username used at the time of creation of DB\r\nPWD=\"my-db-pass\" #Database Master password used at the time of creation of DB\r\n\r\ntry:\r\n    conn = psycopg2.connect(host=ENDPOINT, port=PORT, database=DBNAME, user=USR, password=PWD)\r\n    cur = conn.cursor()\r\n    cur.execute(\"\"\"SELECT now()\"\"\") #Confirming the connection\r\n    query_results = cur.fetchall()\r\n    print(query_results)\r\nexcept Exception as e:\r\n    print(\"Database connection failed due to {}\".format(e))  ","user":"anonymous","dateUpdated":"2020-07-13T13:39:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(datetime.datetime(2020, 7, 13, 13, 39, 29, 871733, tzinfo=psycopg2.tz.FixedOffsetTimezone(offset=0, name=None)),)]\n"}]},"apps":[],"jobName":"paragraph_1594463131822_-1914118383","id":"20200711-102531_158817213","dateCreated":"2020-07-11T10:25:31+0000","dateStarted":"2020-07-13T13:39:28+0000","dateFinished":"2020-07-13T13:39:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:196"},{"text":"%md\n<li>CREATE - INSERT</li>\n<li>READ</li>\n<li>UPDATE</li>\n<li>DELETE</li>","user":"anonymous","dateUpdated":"2020-07-15T09:56:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false,"title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594806718826_979031189","id":"20200715-095158_1593017873","dateCreated":"2020-07-15T09:51:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1415","dateFinished":"2020-07-15T09:56:39+0000","dateStarted":"2020-07-15T09:56:39+0000","title":"PostgreSQL CRUD operations from Python","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<li>CREATE - INSERT</li>\n<li>READ</li>\n<li>UPDATE</li>\n<li>DELETE</li>\n</div>"}]}},{"title":"Creating table \"MOVIES\"","text":"%pyspark\n\ncur.execute(\"\"\"drop table if exists public.\"MOVIES\";\n                create table public.\"MOVIES\"(\n                MOVIE_ID integer primary key,\n                TITLE text,\n                GENRES text)\"\"\")\n\nwith open('/downloads/ml-latest-small/movies.txt', 'r') as f: #File path looks like linux filesytem because Zeppelin is running under Docker linux container setup.\n    f.readline() # Skip the header row\n    cur.copy_from(f, 'public.\"MOVIES\"', sep='\\t', null=\"\")\n\nconn.commit()\n\n# Printing first 5 rows\ncur.execute(\"\"\"SELECT * FROM public.\"MOVIES\" LIMIT 5\"\"\")\ncur.fetchall()","user":"anonymous","dateUpdated":"2020-07-13T13:35:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 'Toy Story (1995)', 'Adventure|Animation|Children|Comedy|Fantasy'), (2, 'Jumanji (1995)', 'Adventure|Children|Fantasy'), (3, 'Grumpier Old Men (1995)', 'Comedy|Romance'), (4, 'Waiting to Exhale (1995)', 'Comedy|Drama|Romance'), (5, 'Father of the Bride Part II (1995)', 'Comedy')]\n"}]},"apps":[],"jobName":"paragraph_1594468151082_-778725500","id":"20200711-114911_159975758","dateCreated":"2020-07-11T11:49:11+0000","dateStarted":"2020-07-13T13:31:12+0000","dateFinished":"2020-07-13T13:31:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:197"},{"title":"Creating table \"LINKS\"","text":"%pyspark\n\ncur.execute(\"\"\"drop table if exists public.\"LINKS\";\n                create table public.\"LINKS\"(\n                MOVIE_ID integer primary key,\n                IMDB_ID integer,\n                TMDB_ID integer)\"\"\")\n\nwith open('/downloads/ml-latest-small/links.txt', 'r') as f:\n    f.readline() # Skip the header row\n    cur.copy_from(f, 'public.\"LINKS\"', sep='\\t', null=\"\")\n\nconn.commit()\n\n# Printing first 5 rows\ncur.execute(\"\"\"SELECT * FROM public.\"LINKS\" LIMIT 5\"\"\")\ncur.fetchall()","user":"anonymous","dateUpdated":"2020-07-13T11:55:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(1, 114709, 862), (2, 113497, 8844), (3, 113228, 15602), (4, 114885, 31357), (5, 113041, 11862)]\n"}]},"apps":[],"jobName":"paragraph_1594481209190_1991006414","id":"20200711-152649_513121435","dateCreated":"2020-07-11T15:26:49+0000","dateStarted":"2020-07-13T11:55:23+0000","dateFinished":"2020-07-13T11:55:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:198"},{"title":"Creating table \"RATINGS\"","text":"%pyspark\n\ncur.execute(\"\"\"drop table if exists public.\"RATINGS\";\n                create table public.\"RATINGS\"(\n                USER_ID integer,\n                MOVIE_ID integer,\n                RATING float,\n                TIMESTAMP text)\"\"\")\n\nwith open('/downloads/ml-latest-small/ratings.txt', 'r') as f:\n    f.readline() # Skip the header row\n    cur.copy_from(f, 'public.\"RATINGS\"', sep='\\t', null=\"\")\n\nconn.commit()\n\n# Printing first 5 rows\ncur.execute(\"\"\"SELECT * FROM public.\"RATINGS\" LIMIT 5\"\"\")\ncur.fetchall()","user":"anonymous","dateUpdated":"2020-07-13T11:55:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(7, 1, 3.0, '851866703'), (9, 1, 4.0, '938629179'), (13, 1, 5.0, '1331380058'), (15, 1, 2.0, '997938310'), (19, 1, 3.0, '855190091')]\n"}]},"apps":[],"jobName":"paragraph_1594633070553_-1373179116","id":"20200713-093750_1821964436","dateCreated":"2020-07-13T09:37:50+0000","dateStarted":"2020-07-13T11:55:27+0000","dateFinished":"2020-07-13T11:55:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:199"},{"title":"Creating table \"TAGS\"","text":"%pyspark\n\ncur.execute(\"\"\"drop table if exists public.\"TAGS\";\n                create table public.\"TAGS\"(\n                USER_ID integer,\n                MOVIE_ID integer,\n                TAG text,\n                TIMESTAMP text)\"\"\")\n\nwith open('/downloads/ml-latest-small/tags.txt', 'r') as f:\n    f.readline() # Skip the header row\n    cur.copy_from(f, 'public.\"TAGS\"', sep='\\t')\n\nconn.commit()\n\n# Printing first 5 rows\ncur.execute(\"\"\"select * from public.\"TAGS\" limit 5\"\"\")\ncur.fetchall()","user":"anonymous","dateUpdated":"2020-07-13T11:55:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[(501, 1, 'Pixar', '1292956344'), (431, 5, 'steve martin', '1140455432'), (364, 47, 'biblical', '1444534976'), (364, 47, 'crime', '1444534982'), (364, 47, 'dark', '1444534994')]\n"}]},"apps":[],"jobName":"paragraph_1594633379211_-557666334","id":"20200713-094259_2096845406","dateCreated":"2020-07-13T09:42:59+0000","dateStarted":"2020-07-13T11:55:33+0000","dateFinished":"2020-07-13T11:55:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:200"},{"title":"Insert Query","text":"%pyspark\n\nquery = \"\"\" insert into public.\"MOVIES\" (MOVIE_ID, TITLE, GENRES) values (%s,%s,%s)\"\"\"\nrecord_to_insert = ( '1000000' , 'Once Upon a Time... in Hollywood (2019)',  'Comedy|Drama')\ncur.execute(query, record_to_insert)\n\nconn.commit()\ncount = cur.rowcount\nprint (count, \"Record inserted successfully into MOVIES table\")","user":"anonymous","dateUpdated":"2020-07-13T11:55:36+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(1, 'Record inserted successfully into MOVIES table')\n"}]},"apps":[],"jobName":"paragraph_1594633071695_-542890989","id":"20200713-093751_1634266251","dateCreated":"2020-07-13T09:37:51+0000","dateStarted":"2020-07-13T11:55:36+0000","dateFinished":"2020-07-13T11:55:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:201"},{"title":"Update Query","text":"%pyspark\n\nprint(\"Table Before updating record \")\nquery = \"\"\"select * from public.\"MOVIES\" where MOVIE_ID = %s\"\"\"\ncur.execute(query, (1000000, ))\nrecord = cur.fetchone()\nprint(record)\n\n# Update single record now\nquery = \"\"\"Update public.\"MOVIES\" set TITLE = %s where MOVIE_ID = %s\"\"\"\ncur.execute(query, ('Once Upon a Time in Hollywood (2019)', 1000000))\nconn.commit()\ncount = cur.rowcount\nprint(count, \"Record Updated successfully \")\n\nprint(\"Table After updating record \")\nquery = \"\"\"select * from public.\"MOVIES\" where MOVIE_ID = %s\"\"\"\ncur.execute(query, (1000000,))\nrecord = cur.fetchone()\nprint(record)","user":"anonymous","dateUpdated":"2020-07-13T11:55:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Table Before updating record \n(1000000, 'Once Upon a Time... in Hollywood (2019)', 'Comedy|Drama')\n(1, 'Record Updated successfully ')\nTable After updating record \n(1000000, 'Once Upon a Time in Hollywood (2019)', 'Comedy|Drama')\n"}]},"apps":[],"jobName":"paragraph_1594640296315_344095835","id":"20200713-113816_702479358","dateCreated":"2020-07-13T11:38:16+0000","dateStarted":"2020-07-13T11:55:39+0000","dateFinished":"2020-07-13T11:55:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:202"},{"title":"Delete Query","text":"%pyspark\n\nquery = \"\"\" delete from public.\"MOVIES\" where MOVIE_ID = %s\"\"\"\ncur.execute(query, (1000000,))\n\nconn.commit()\ncount = cur.rowcount\nprint(count, \"Record deleted successfully \")","user":"anonymous","dateUpdated":"2020-07-13T11:55:45+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","editorHide":false,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"(1, 'Record deleted successfully ')\n"}]},"apps":[],"jobName":"paragraph_1594640856034_1655550702","id":"20200713-114736_1797873518","dateCreated":"2020-07-13T11:47:36+0000","dateStarted":"2020-07-13T11:55:45+0000","dateFinished":"2020-07-13T11:55:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:203"},{"text":"%pyspark\n\nquery = \"\"\" select * from public.\"MOVIES\" where MOVIE_ID = %s \"\"\"\ncur.execute(query, (1000000,))\n\ncur.fetchall()","user":"anonymous","dateUpdated":"2020-07-13T13:39:53+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[]\n"}]},"apps":[],"jobName":"paragraph_1594639613348_-1435008271","id":"20200713-112653_1278930104","dateCreated":"2020-07-13T11:26:53+0000","dateStarted":"2020-07-13T13:39:53+0000","dateFinished":"2020-07-13T13:39:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:204"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-07-13T13:38:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1594647527217_-1710685897","id":"20200713-133847_1740517835","dateCreated":"2020-07-13T13:38:47+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:205"}],"name":"P3","id":"2FFCNE9ZH","angularObjects":{"2FA5T9WYD:shared_process":[],"2F7T4SVX8:shared_process":[],"2F99CZ69Y:shared_process":[],"2FA1WJ9CP:shared_process":[],"2FAWJM25X:shared_process":[],"2F94EQ4DX:shared_process":[],"2F92Z674U:shared_process":[],"2F7EDR25S:shared_process":[],"2FBBEW7SU:shared_process":[],"2F8KHSAWS:shared_process":[],"2FAGKCWGP:shared_process":[],"2F9CQ7U6V:shared_process":[],"2FADKU7FP:shared_process":[],"2F7P7EDBM:shared_process":[],"2FA7UUDXH:shared_process":[],"2F8BYBNYW:shared_process":[],"2F8WZWUJC:shared_process":[],"2F7MJ21WJ:shared_process":[],"2F9YNAYFJ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}