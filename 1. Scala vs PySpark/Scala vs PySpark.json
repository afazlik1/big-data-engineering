{"paragraphs":[{"text":"%md\n\nMulti-purpose Notebook\n\nThe Notebook is the place for all your needs\n\n    Data Ingestion\n    Data Discovery\n    Data Analytics\n    Data Visualization & Collaboration\n\n\n","user":"anonymous","dateUpdated":"2020-06-04T11:21:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Multi-purpose Notebook</p>\n<p>The Notebook is the place for all your needs</p>\n<pre><code>Data Ingestion\nData Discovery\nData Analytics\nData Visualization &amp; Collaboration\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1591193246922_-694444954","id":"20200521-101945_941341710","dateCreated":"2020-06-03T14:07:26+0000","dateStarted":"2020-06-04T11:21:46+0000","dateFinished":"2020-06-04T11:21:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:282"},{"text":"%spark\n\nobject hello\n{\n    def main(args: Array[String])\n    {\n        print(\"\\n\\n>>>>> START OF PROGRAM <<<<<\\n\\n\");\n        println(\"Hello World.\")\n        print(\"\\n\\n>>>>> END OF PROGRAM <<<<<\\n\\n\");\n    }\n}\n","user":"anonymous","dateUpdated":"2020-06-04T11:21:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndefined object hello\n"}]},"apps":[],"jobName":"paragraph_1591269049028_576300909","id":"20200604-111049_1499215578","dateCreated":"2020-06-04T11:10:49+0000","dateStarted":"2020-06-04T11:21:49+0000","dateFinished":"2020-06-04T11:22:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:283"},{"text":"%spark\nval distFile = sc.textFile(\"file:///downloads/Data/\")\ndistFile.count()\ndistFile.take(10).foreach(println)","user":"anonymous","dateUpdated":"2020-06-04T12:42:09+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndistFile: org.apache.spark.rdd.RDD[String] = file:///downloads/Data/ MapPartitionsRDD[94] at textFile at <console>:103\n\nres294: Long = 60192840\nYear,Month,DayofMonth,DayOfWeek,DepTime,CRSDepTime,ArrTime,CRSArrTime,UniqueCarrier,FlightNum,TailNum,ActualElapsedTime,CRSElapsedTime,AirTime,ArrDelay,DepDelay,Origin,Dest,Distance,TaxiIn,TaxiOut,Cancelled,CancellationCode,Diverted,CarrierDelay,WeatherDelay,NASDelay,SecurityDelay,LateAircraftDelay\n1999,1,27,3,1906,1908,2024,2005,US,1244,N942VJ,78,57,66,19,-2,RIC,PHL,198,3,9,0,NA,0,NA,NA,NA,NA,NA\n1999,1,28,4,2016,1908,2126,2005,US,1244,N955VJ,70,57,41,81,68,RIC,PHL,198,19,10,0,NA,0,NA,NA,NA,NA,NA\n1999,1,29,5,1907,1908,2000,2005,US,1244,N929VJ,53,57,43,-5,-1,RIC,PHL,198,2,8,0,NA,0,NA,NA,NA,NA,NA\n1999,1,31,7,1932,1908,2031,2005,US,1244,N912VJ,59,57,45,26,24,RIC,PHL,198,6,8,0,NA,0,NA,NA,NA,NA,NA\n1999,1,1,5,1601,1535,1707,1645,US,297,N935VJ,66,70,47,22,26,ROC,PHL,257,11,8,0,NA,0,NA,NA,NA,NA,NA\n1999,1,2,6,1651,1535,1829,1645,US,297,N980VJ,98,70,57,104,76,ROC,PHL,257,34,7,0,NA,0,NA,NA,NA,NA,NA\n1999,1,3,7,NA,1535,NA,1645,US,297,UNKNOW,NA,70,NA,NA,NA,ROC,PHL,257,0,0,1,NA,0,NA,NA,NA,NA,NA\n1999,1,4,1,1559,1535,1707,1645,US,297,N893US,68,70,58,22,24,ROC,PHL,257,4,6,0,NA,0,NA,NA,NA,NA,NA\n1999,1,5,2,1545,1535,1703,1645,US,297,N864US,78,70,61,18,10,ROC,PHL,257,13,4,0,NA,0,NA,NA,NA,NA,NA\n"}]},"apps":[],"jobName":"paragraph_1591193246925_-697138196","id":"20200513-143454_934792498","dateCreated":"2020-06-03T14:07:26+0000","dateStarted":"2020-06-04T12:42:09+0000","dateFinished":"2020-06-04T12:44:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:284"},{"text":"%spark\nz.put(\"data\", distFile)","user":"anonymous","dateUpdated":"2020-06-04T12:44:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1591193338816_1256970819","id":"20200603-140858_132786735","dateCreated":"2020-06-03T14:08:58+0000","dateStarted":"2020-06-04T12:44:56+0000","dateFinished":"2020-06-04T12:44:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:285"},{"text":"%pyspark\nfrom pyspark.sql import DataFrame\ndf = DataFrame(z.get(\"data\"), sqlContext)","user":"anonymous","dateUpdated":"2020-06-04T14:08:06+0000","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false},"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1591193246925_-697138196","id":"20200515-104408_1394652924","dateCreated":"2020-06-03T14:07:26+0000","dateStarted":"2020-06-04T14:08:06+0000","dateFinished":"2020-06-04T14:08:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:286"},{"text":"%pyspark\ndf.count()","user":"anonymous","dateUpdated":"2020-06-04T14:08:19+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"60192840\n"}]},"apps":[],"jobName":"paragraph_1591269403691_962662137","id":"20200604-111643_1810996699","dateCreated":"2020-06-04T11:16:43+0000","dateStarted":"2020-06-04T14:08:19+0000","dateFinished":"2020-06-04T14:10:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:287"},{"text":"%spark\n//Year,Month,DayofMonth,DayOfWeek,DepTime,CRSDepTime,ArrTime,CRSArrTime,UniqueCarrier,FlightNum,TailNum,ActualElapsedTime,CRSElapsedTime,AirTime,ArrDelay,DepDelay,Origin,Dest,Distance,Tax,TaxiOut,Cancelled,CancellationCode,Diverted,CarrierDelay,WeatherDelay,NASDelay,SecurityDelay,LateAircraftDelay\n\ncase class Flight(Year: String, Month: String)\nvar distFile1 = distFile.map(_.split(\",\")).map(p => Flight(p(0), p(1)))\n\ndistFile1.toDF().createOrReplaceTempView(\"flights\")\n\nval yearmonth = sqlContext.sql(\"SELECT Year, Month, COUNT(*) FROM flights GROUP BY Year, Month\")","user":"anonymous","dateUpdated":"2020-06-04T12:49:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\ndefined class Flight\n\ndistFile1: org.apache.spark.rdd.RDD[Flight] = MapPartitionsRDD[108] at map at <console>:107\n\nyearmonth: org.apache.spark.sql.DataFrame = [Year: string, Month: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1591193852437_1360003615","id":"20200603-141732_835719360","dateCreated":"2020-06-03T14:17:32+0000","dateStarted":"2020-06-04T12:48:05+0000","dateFinished":"2020-06-04T12:48:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:288"},{"text":"%spark\nyearmonth.show()","user":"anonymous","dateUpdated":"2020-06-04T12:50:59+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-----+--------+\n|Year|Month|count(1)|\n+----+-----+--------+\n|2002|    2|  399535|\n|2003|    9|  527714|\n|2001|   10|  443796|\n|2002|    3|  447896|\n|2007|    7|  648560|\n|2005|    5|  614802|\n|2002|    4|  438141|\n|2001|    2|  477824|\n|2007|    9|  600187|\n|1999|    4|  450620|\n|2002|    8|  466764|\n|2003|    6|  536496|\n|2006|    8|  628732|\n|2000|   11|  467251|\n|2005|   10|  592712|\n|2003|    4|  527303|\n|2001|    7|  538440|\n|2007|   12|  614139|\n|2001|    1|  529940|\n|2003|   10|  552370|\n+----+-----+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1591193246930_-685210980","id":"20200521-103431_1150502552","dateCreated":"2020-06-03T14:07:26+0000","dateStarted":"2020-06-04T12:48:09+0000","dateFinished":"2020-06-04T12:50:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:289"},{"text":"%pyspark\nfrom pyspark.sql import SQLContext\nfrom pyspark.sql.types import *\n\nsqlContext = SQLContext(sc)\n\nparts = df.map(lambda l: l.split(\",\"))\nflights = parts.map(lambda p: (p[0], p[1].strip()))\n\nschemaString = \"Year Month\"\n\nfields = [StructField(field_name, StringType(), True) for field_name in schemaString.split()]\nschema = StructType(fields)\n\nschemaflights = sqlContext.createDataFrame(flights, schema)\n\nschemaflights.createOrReplaceTempView(\"flights\")\n\nsqlDF = sqlContext.sql(\"SELECT Year, Month, COUNT(*) FROM flights GROUP BY Year, Month\")","user":"anonymous","dateUpdated":"2020-06-04T15:02:48+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-4864315722672381151.py\", line 367, in <module>\n    raise Exception(traceback.format_exc())\nException: Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark-4864315722672381151.py\", line 355, in <module>\n    exec(code, _zcUserQueryNameSpace)\n  File \"<stdin>\", line 4, in <module>\n  File \"/zeppelin/interpreter/spark/pyspark/pyspark.zip/pyspark/sql/dataframe.py\", line 962, in __getattr__\n    if name not in self.columns:\n  File \"/zeppelin/interpreter/spark/pyspark/pyspark.zip/pyspark/sql/dataframe.py\", line 687, in columns\n    return [f.name for f in self.schema.fields]\n  File \"/zeppelin/interpreter/spark/pyspark/pyspark.zip/pyspark/sql/dataframe.py\", line 227, in schema\n    self._schema = _parse_datatype_json_string(self._jdf.schema().json())\n  File \"/zeppelin/interpreter/spark/pyspark/py4j-0.10.4-src.zip/py4j/java_gateway.py\", line 1133, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/zeppelin/interpreter/spark/pyspark/pyspark.zip/pyspark/sql/utils.py\", line 63, in deco\n    return f(*a, **kw)\n  File \"/zeppelin/interpreter/spark/pyspark/py4j-0.10.4-src.zip/py4j/protocol.py\", line 323, in get_return_value\n    format(target_id, \".\", name, value))\nPy4JError: An error occurred while calling o45.schema. Trace:\npy4j.Py4JException: Method schema([]) does not exist\n\tat py4j.reflection.ReflectionEngine.getMethod(ReflectionEngine.java:318)\n\tat py4j.reflection.ReflectionEngine.getMethod(ReflectionEngine.java:326)\n\tat py4j.Gateway.invoke(Gateway.java:272)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:748)\n\n\n\n"}]},"apps":[],"jobName":"paragraph_1591279638879_536546340","id":"20200604-140718_1796369667","dateCreated":"2020-06-04T14:07:18+0000","dateStarted":"2020-06-04T15:02:48+0000","dateFinished":"2020-06-04T15:02:48+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:290"},{"text":"%pyspark\nsqlDF.show()","user":"anonymous","dateUpdated":"2020-06-04T14:21:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591195090916_-1880978269","id":"20200603-143810_181810495","dateCreated":"2020-06-03T14:38:10+0000","dateStarted":"2020-06-04T14:21:02+0000","dateFinished":"2020-06-04T14:21:02+0000","status":"ERROR","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:291"},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-06-04T13:58:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1591279129273_1657399796","id":"20200604-135849_886071398","dateCreated":"2020-06-04T13:58:49+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:292"}],"name":"Scala vs PySpark-Example2","id":"2FBEW22A8","angularObjects":{"2FA5T9WYD:shared_process":[],"2F7T4SVX8:shared_process":[],"2F99CZ69Y:shared_process":[],"2FA1WJ9CP:shared_process":[],"2FAWJM25X:shared_process":[],"2F94EQ4DX:shared_process":[],"2F92Z674U:shared_process":[],"2F7EDR25S:shared_process":[],"2FBBEW7SU:shared_process":[],"2F8KHSAWS:shared_process":[],"2FAGKCWGP:shared_process":[],"2F9CQ7U6V:shared_process":[],"2FADKU7FP:shared_process":[],"2F7P7EDBM:shared_process":[],"2FA7UUDXH:shared_process":[],"2F8BYBNYW:shared_process":[],"2F8WZWUJC:shared_process":[],"2F7MJ21WJ:shared_process":[],"2F9YNAYFJ:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}